require 'app/services/similarity/content_processor'

class ResourceObserver < ActiveRecord::Observer       
  def after_save(r)
      if r.role.casecmp("resume") == 0       
         puts "Processing Resume Resource..."
         p = ContentProcessor.new
         puts "#{r.f.path}"         
         content = IO.readlines(r.f.path)         
         p.process_content("#{r.engineer.name.to_s.squeeze(' ').tr(' ','_')}_resume",[content])
         # Clean and create data file for resource.
         
         #rpath = "#{p.data_directory}/engineer_#{r.engineer_id}.yml"
         #docSet = DocumentSet.new
         #scores = docSet.getSetSimilarityToOwner(p.data_directory,"e_#{r.engineer_id}")
         p.printUserSimilarity
      else
         puts "Resource is not a resume!"
      end      
   end   
end